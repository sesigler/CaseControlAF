<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case Control Allele Frequency Reconstruction â€¢ CaseControlAF</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Case Control Allele Frequency Reconstruction">
<meta property="og:description" content="Functions to reconstruct case and control AFs from summary statistics. One function uses OR, NCase, NControl, and SE(log(OR)). The second function uses OR, NCase, NControl, and AF for the whole sample.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CaseControlAF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="casecontrolaf">CaseControlAF<a class="anchor" aria-label="anchor" href="#casecontrolaf"></a>
</h1></div>
<p>Case Control Allele Frequency (AF) Reconstruction R Package</p>
<p>This repository contains the source code for the CaseControlAF R package which can be used to reconstruct the allele frequency (AF) for cases and controls separately given commonly available summary statistics.</p>
<p>The package contains two functions:</p>
<ol style="list-style-type: decimal">
<li>CaseControl_AF</li>
<li>CaseControl_SE</li>
</ol>
<div class="section level2">
<h2 id="download-the-package">Download the package<a class="anchor" aria-label="anchor" href="#download-the-package"></a>
</h2>
<p>To download this package using <em>devtools</em> in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/wolffha/CaseControlAF"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="casecontrol_af">CaseControl_AF<a class="anchor" aria-label="anchor" href="#casecontrol_af"></a>
</h2>
<p>Use this function when you have the following statistics (for each variant) * Number of cases * Number of controls * Odds Ratio (OR) or beta coefficient * <strong>AF</strong> for the whole sample (cases and controls combined)</p>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p><strong>N_case</strong>: an integer for the number of case samples</p>
<p><strong>N_control</strong>: an integer for the number of control samples</p>
<p><strong>OR</strong>: a numeric vector with the OR (or exp(beta)) for each variant</p>
<p><strong>AF_population</strong>: a numeric vector with the AF for each variant</p>
<p>Returns a dataframe with two columns: AF_case and AF_control. The number of rows is equal to the number of variants.</p>
</div>
</div>
<div class="section level2">
<h2 id="casecontrol_se">CaseControl_SE<a class="anchor" aria-label="anchor" href="#casecontrol_se"></a>
</h2>
<p>Use this function when you have the following statistics (for each variant) * Number of cases * Number of controls * Odds Ratio (OR) or beta coefficient * <strong>SE</strong> of the log(OR) for each variant</p>
<p><em>Code adapted from ReACt GroupFreq function available here: (<a href="https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c" class="external-link uri">https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c</a>)</em></p>
<div class="section level3">
<h3 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h3>
<p><strong>N_case</strong>: an integer for the number of case samples</p>
<p><strong>N_control</strong>: an integer for the number of control samples</p>
<p><strong>OR</strong>: a numeric vector with the OR (or exp(beta)) for each variant</p>
<p><strong>SE</strong>: a numeric vector with the SE(log(OR)) for each variant</p>
<p>Returns a dataframe with three columns with names: MAF_case, MAF_control and MAF_pop containing the estimated minor allele frequency in the cases, controls, and whole sample. The number of rows is equal to the number of variants</p>
<p><strong>NOTE:</strong> This method assumes we are estimating the minor allele frequency (MAF)</p>
</div>
</div>
<div class="section level2">
<h2 id="a-small-example">A small example<a class="anchor" aria-label="anchor" href="#a-small-example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SampleDat"</span><span class="op">)</span></span>
<span><span class="co"># this sample data contains 148 variants from a prostate cancer GWAS with the below sample sizes</span></span>
<span></span>
<span><span class="va">nCase_sample</span> <span class="op">=</span> <span class="fl">79148</span></span>
<span><span class="va">nControl_sample</span> <span class="op">=</span> <span class="fl">61106</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">SampleDat</span><span class="op">)</span></span>
<span><span class="co">#  rsid case_af control_af case_maf control_maf     SE   OR</span></span>
<span><span class="co">#1    1  0.6917     0.6825   0.3083      0.3175 0.0086 1.18</span></span>
<span><span class="co">#2    2  0.2295     0.2181   0.2295      0.2181 0.0096 1.07</span></span>
<span><span class="co">#3    3  0.4580     0.4467   0.4580      0.4467 0.0080 1.05</span></span>
<span><span class="co">#4    4  0.7554     0.7379   0.2446      0.2621 0.0091 1.10</span></span>
<span><span class="co">#5    5  0.3675     0.3575   0.3675      0.3575 0.0083 1.06</span></span>
<span><span class="co">#6    6  0.7141     0.6995   0.2859      0.3005 0.0087 1.07</span></span>
<span></span>
<span><span class="co"># calculate whole sample true AF</span></span>
<span><span class="va">SampleDat</span><span class="op">$</span><span class="va">true_AF</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SampleDat</span><span class="op">$</span><span class="va">case_af</span> <span class="op">*</span> <span class="va">nCase_sample</span> <span class="op">+</span> <span class="va">SampleDat</span><span class="op">$</span><span class="va">control_af</span> <span class="op">*</span> <span class="va">nControl_sample</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="va">nCase_sample</span> <span class="op">+</span> <span class="va">nControl_sample</span><span class="op">)</span></span>
<span></span>
<span><span class="va">af_method_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CaseControl_AF.html">CaseControl_AF</a></span><span class="op">(</span>N_case <span class="op">=</span> <span class="va">nCase_sample</span>,</span>
<span>                                    N_control <span class="op">=</span> <span class="va">nControl_sample</span>,</span>
<span>                                    OR <span class="op">=</span> <span class="va">SampleDat</span><span class="op">$</span><span class="va">OR</span>,</span>
<span>                                    AF_population <span class="op">=</span> <span class="va">SampleDat</span><span class="op">$</span><span class="va">true_AF</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">)</span></span>
<span><span class="co">#  AF_case AF_control</span></span>
<span><span class="co">#1  0.6917     0.6825</span></span>
<span><span class="co">#2  0.2295     0.2181</span></span>
<span><span class="co">#3  0.4580     0.4467</span></span>
<span><span class="co">#4  0.7554     0.7379</span></span>
<span><span class="co">#5  0.3675     0.3575</span></span>
<span><span class="co">#6  0.7141     0.6995</span></span>
<span></span>
<span><span class="co"># visualise the bias in the results compared to the published true AFs</span></span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">$</span><span class="va">AF_case</span>, <span class="va">af_method_results</span><span class="op">$</span><span class="va">AF_control</span><span class="op">)</span>,</span>
<span>                       true <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">$</span><span class="va">Case_Affected_Frequency</span>, </span>
<span>                                <span class="va">af_method_results</span><span class="op">$</span><span class="va">Control_Affected_Frequency</span><span class="op">)</span>,</span>
<span>                       status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># smaple PC plot for package</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plotdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true</span>, y <span class="op">=</span> <span class="va">estimated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True AF"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Estimated AF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">status</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/CaseControl_AF_example.png" height="70%" width="70%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_method_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>N_case <span class="op">=</span> <span class="va">nCase_sample</span>,</span>
<span>                                    N_control <span class="op">=</span> <span class="va">nControl_sample</span>,</span>
<span>                                    OR <span class="op">=</span> <span class="va">SampleDat</span><span class="op">$</span><span class="va">OR</span>,</span>
<span>                                    SE <span class="op">=</span> <span class="va">SampleDat</span><span class="op">$</span><span class="va">SE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">)</span></span>
<span><span class="co">#  MAF_case    MAF_control MAF_pop</span></span>
<span><span class="co">#1 0.2721196   0.2637265   0.2684629</span></span>
<span><span class="co">#2 0.2013120   0.1909652   0.1968041</span></span>
<span><span class="co">#3 0.3521112   0.3417763   0.3476085</span></span>
<span><span class="co">#4 0.2354858   0.2192349   0.2284056</span></span>
<span><span class="co">#5 0.3058994   0.2967891   0.3019302</span></span>
<span><span class="co">#6 0.2657115   0.2521924   0.2598215</span></span>
<span></span>
<span><span class="co"># visualize the bias in results compared to the published minor allele frequency (MAF)</span></span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case</span>, <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control</span><span class="op">)</span>,</span>
<span>                       true <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">$</span><span class="va">case_maf</span>,<span class="va">se_method_results</span><span class="op">$</span><span class="va">control_maf</span><span class="op">)</span>,</span>
<span>                       status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># smaple PC plot for package</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plotdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true</span>, y <span class="op">=</span> <span class="va">estimated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True MAF"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Estimated MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">status</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/CaseControl_SE_example.png" height="70%" width="70%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CaseControlAF</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>The package maintainer <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
