<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case Control Allele Frequency Reconstruction • CaseControlAF</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Case Control Allele Frequency Reconstruction">
<meta property="og:description" content="Functions to reconstruct case and control AFs from summary statistics. One function uses OR, NCase, NControl, and SE(log(OR)). The second function uses OR, NCase, NControl, and AF for the whole sample.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CaseControlAF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="casecontrolaf">CaseControlAF<a class="anchor" aria-label="anchor" href="#casecontrolaf"></a>
</h1></div>
<p>Case Control Allele Frequency (AF) Reconstruction R Package</p>
<p>This repository contains the source code for the CaseControlAF R package which can be used to reconstruct the allele frequency (AF) for cases and controls separately given commonly available summary statistics.</p>
<p>The package contains two functions:</p>
<ol style="list-style-type: decimal">
<li>CaseControl_AF</li>
<li>CaseControl_SE</li>
</ol>
<div class="section level2">
<h2 id="download-the-package">Download the package<a class="anchor" aria-label="anchor" href="#download-the-package"></a>
</h2>
<p>To download this package using <em>devtools</em> in R:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/wolffha/CaseControlAF"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="casecontrol_af">CaseControl_AF<a class="anchor" aria-label="anchor" href="#casecontrol_af"></a>
</h2>
<p>Use this function when you have the following statistics (for each variant) * Number of cases * Number of controls * Odds Ratio (OR) or beta coefficient * <strong>AF</strong> for the whole sample (cases and controls combined)</p>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p><strong>N_case</strong>: an integer for the number of case samples</p>
<p><strong>N_control</strong>: an integer for the number of control samples</p>
<p><strong>OR</strong>: a numeric vector with the OR (or exp(beta)) for each variant</p>
<p><strong>AF_population</strong>: a numeric vector with the AF for each variant</p>
<p>Returns a dataframe with two columns: AF_case and AF_control. The number of rows is equal to the number of variants.</p>
</div>
</div>
<div class="section level2">
<h2 id="casecontrol_se">CaseControl_SE<a class="anchor" aria-label="anchor" href="#casecontrol_se"></a>
</h2>
<p>Use this function when you have the following statistics (for each variant) * Number of cases * Number of controls * Odds Ratio (OR) or beta coefficient * <strong>SE</strong> of the log(OR) for each variant</p>
<p><em>Code adapted from ReACt GroupFreq function available here: (<a href="https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c" class="external-link uri">https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c</a>)</em></p>
<div class="section level3">
<h3 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h3>
<p><strong>N_case</strong>: an integer for the number of case samples</p>
<p><strong>N_control</strong>: an integer for the number of control samples</p>
<p><strong>OR</strong>: a numeric vector with the OR (or exp(beta)) for each variant</p>
<p><strong>SE</strong>: a numeric vector with the SE(log(OR)) for each variant</p>
<p>Returns a dataframe with three columns with names: MAF_case, MAF_control and MAF_pop containing the estimated minor allele frequency in the cases, controls, and whole sample. The number of rows is equal to the number of variants</p>
<p><strong>NOTE:</strong> This method assumes we are estimating the minor allele frequency (MAF)</p>
</div>
</div>
<div class="section level2">
<h2 id="a-small-example">A small example<a class="anchor" aria-label="anchor" href="#a-small-example"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"sampleDat"</span><span class="op">)</span></span>
<span><span class="co"># this sample data contains 148 variants from a prostate cancer GWAS with the below sample sizes</span></span>
<span></span>
<span><span class="va">nCase_sample</span> <span class="op">=</span> <span class="fl">16550</span></span>
<span><span class="va">nControl_sample</span> <span class="op">=</span> <span class="fl">403923</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span></span>
<span><span class="co"># A tibble: 6 × 11</span></span>
<span><span class="co"># Rowwise: </span></span>
<span><span class="co">#  CHR         POS REF   ALT   true_maf_case true_maf_control      beta     SE gnomad_maf    OR true_maf_pop</span></span>
<span><span class="co">#  &lt;chr&gt;     &lt;int&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#1 chr1  226824710 C     T         0.205            0.204      0.000344 0.0147  0.204     1.00     0.204    </span></span>
<span><span class="co">#2 chr1  117812346 G     A         0.448            0.447     -0.00139  0.0120  0.446     0.999    0.447    </span></span>
<span><span class="co">#3 chr1  230838863 C     T         0.165            0.164      0.00422  0.0162  0.183     1.00     0.164    </span></span>
<span><span class="co">#4 chr1   93121792 ATT   A         0                0         -0.106    3.53    0.000108  0.900    0        </span></span>
<span><span class="co">#5 chr1  240236388 G     A         0.0000111        0.0000378 -1.25     1.25    0.0000882 0.285    0.0000367</span></span>
<span><span class="co">#6 chr1   12385196 G     A         0.0139           0.0140    -0.0153   0.0505  0.0116    0.985    0.0140 </span></span>
<span></span>
<span><span class="va">af_method_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CaseControl_AF.html">CaseControl_AF</a></span><span class="op">(</span>N_case <span class="op">=</span> <span class="va">nCase_sample</span>,</span>
<span>                                    N_control <span class="op">=</span> <span class="va">nControl_sample</span>,</span>
<span>                                    OR <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">OR</span>,</span>
<span>                                    AF_population <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_pop</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">)</span></span>
<span><span class="co">#       AF_case   AF_control</span></span>
<span><span class="co">#1 2.041813e-01 2.041254e-01</span></span>
<span><span class="co">#2 4.468049e-01 4.471490e-01</span></span>
<span><span class="co">#3 1.647775e-01 1.641968e-01</span></span>
<span><span class="co">#4 0.000000e+00 0.000000e+00</span></span>
<span><span class="co">#5 1.077692e-05 3.776488e-05</span></span>
<span><span class="co">#6 1.381395e-02 1.402353e-02</span></span>
<span></span>
<span><span class="co"># visualise the bias in the results compared to the published true AFs</span></span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">$</span><span class="va">AF_case</span>, <span class="va">af_method_results</span><span class="op">$</span><span class="va">AF_control</span><span class="op">)</span>,</span>
<span>                       true <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>, </span>
<span>                                <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span><span class="op">)</span>,</span>
<span>                       status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">af_method_results</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot the results</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plotdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true</span>, y <span class="op">=</span> <span class="va">estimated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True AF"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Estimated AF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">status</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/CaseControl_AF_example.png" height="70%" width="70%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_method_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>N_case <span class="op">=</span> <span class="va">nCase_sample</span>,</span>
<span>                                    N_control <span class="op">=</span> <span class="va">nControl_sample</span>,</span>
<span>                                    OR <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">OR</span>,</span>
<span>                                    SE <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">SE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">)</span></span>
<span><span class="co">#      MAF_case  MAF_control      MAF_pop</span></span>
<span><span class="co">#1 1.764905e-01 1.764405e-01 1.764425e-01</span></span>
<span><span class="co">#2 3.263835e-01 3.266896e-01 3.266776e-01</span></span>
<span><span class="co">#3 1.392353e-01 1.387297e-01 1.387496e-01</span></span>
<span><span class="co">#4 2.513875e-06 2.794421e-06 2.783379e-06</span></span>
<span><span class="co">#5 1.946826e-05 6.821993e-05 6.630105e-05</span></span>
<span><span class="co">#6 1.250050e-02 1.269041e-02 1.268294e-02</span></span>
<span></span>
<span><span class="co"># visualize the bias in results compared to the published minor allele frequency (MAF)</span></span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>estimated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case</span>, <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control</span><span class="op">)</span>,</span>
<span>                       true <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,<span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span><span class="op">)</span>,</span>
<span>                       status <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># plot the results</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plotdata</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true</span>, y <span class="op">=</span> <span class="va">estimated</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True MAF"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Estimated MAF"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>, ylim<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">status</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/CaseControl_SE_example.png" height="70%" width="70%"></p>
<p>Here we observe distinct bias, which increases as the MAF increases. We will then use the correction framework described in our paper and implemented here to use gnomAD as a proxy for the true MAF_pop.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_method_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>N_case <span class="op">=</span> <span class="va">nCase_sample</span>,</span>
<span>                                     N_control <span class="op">=</span> <span class="va">nControl_sample</span>,</span>
<span>                                     OR <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">OR</span>,</span>
<span>                                     SE <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">SE</span>, </span>
<span>                                     proxyMAFs <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">gnomad_maf</span><span class="op">)</span></span>
<span>                                     </span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>true_maf_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>, <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,</span>
<span>                                        <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span>, <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span><span class="op">)</span>,</span>
<span>                       maf_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case</span>,</span>
<span>                                   <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case_adj</span>,</span>
<span>                                   <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control</span>,</span>
<span>                                   <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control_adj</span><span class="op">)</span>,</span>
<span>                       pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Uncorrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Corrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Uncorrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Corrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                                     </span>
<span><span class="va">ccc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Corrected"</span>, <span class="st">"Corrected"</span>, <span class="st">"Uncorrected"</span>, <span class="st">"Uncorrected"</span><span class="op">)</span>,</span>
<span>                  pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="st">"Control"</span>, <span class="st">"Case"</span>, <span class="st">"Control"</span><span class="op">)</span>,</span>
<span>                  ccc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case_adj</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>,</span>
<span>                          <span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control_adj</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>,</span>
<span>                          <span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>,</span>
<span>                          <span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span><span class="op">)</span>,</span>
<span>                  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.07</span>, <span class="fl">0.07</span>, <span class="fl">0.07</span>, <span class="fl">0.07</span><span class="op">)</span>,</span>
<span>                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.46</span>, <span class="fl">0.46</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ccc</span><span class="op">$</span><span class="va">ccc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ccc</span><span class="op">$</span><span class="va">ccc</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">ccc</span><span class="op">$</span><span class="va">label</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CCC = "</span>, <span class="va">ccc</span><span class="op">$</span><span class="va">ccc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plotdata</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">true_maf_pop</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span>, </span>
<span>                 <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_maf_pop</span>, y <span class="op">=</span> <span class="va">maf_pop</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccc</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span>, colour <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey40"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Estimated vs True With gnomAD Adjustment"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True MAF (Y)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Estimated MAF (Y')"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">pop</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>                                     </span></code></pre></div>
<p><img src="reference/figures/CaseControl_SE_withCorr.png" height="70%" width="70%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CaseControlAF</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>The package maintainer <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
