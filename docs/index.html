<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Case Control Allele Frequency Reconstruction • CaseControlAF</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Case Control Allele Frequency Reconstruction">
<meta property="og:description" content="Functions to reconstruct case and control AFs from summary statistics. One function uses OR, NCase, NControl, and SE(log(OR)). The second function uses OR, NCase, NControl, and AF for the whole sample.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CaseControlAF</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/CaseControlAF.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/wolffha/CaseControlAF/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="casecontrolaf">CaseControlAF<a class="anchor" aria-label="anchor" href="#casecontrolaf"></a>
</h1></div>
<p>Case Control Allele Frequency (AF) Reconstruction R Package</p>
<p>This repository contains the source code for the CaseControlAF R package which can be used to reconstruct the allele frequency (AF) for cases and controls separately given commonly available summary statistics.</p>
<p>The package contains two functions:</p>
<ol style="list-style-type: decimal">
<li>CaseControl_AF</li>
<li>CaseControl_SE</li>
</ol>
<div class="section level2">
<h2 id="download-the-package">Download the package<a class="anchor" aria-label="anchor" href="#download-the-package"></a>
</h2>
<p>To install this package using BioConductor:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://bioconductor.github.io/BiocManager/" class="external-link">"BiocManager"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"CaseControlAF"</span><span class="op">)</span></span></code></pre></div>
<p>To download this package using <em>devtools</em> in R:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/wolffha/CaseControlAF"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="casecontrol_af">CaseControl_AF<a class="anchor" aria-label="anchor" href="#casecontrol_af"></a>
</h2>
<p>Use this function when you have the following statistics (for each variant)</p>
<ul>
<li>Number of cases</li>
<li>Number of controls</li>
<li>Odds Ratio (OR) or beta coefficient</li>
<li>
<strong>AF</strong> (allele frequency) for the total sample (cases and controls combined)</li>
</ul>
<div class="section level3">
<h3 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h3>
<p><strong>data</strong>: a dataframe with a row for each variant and columns for OR and total AF</p>
<p><strong>N_case</strong>: an integer for the number of case samples</p>
<p><strong>N_control</strong>: an integer for the number of control samples</p>
<p><strong>OR_colname</strong>: a string containing the exact column name in ‘data’ with the OR</p>
<p><strong>AF_total_colname</strong>: a string containing the exact column name in ‘data’ with the total AF</p>
<p>Returns a dataframe with two columns: AF_case and AF_control. The number of rows is equal to the number of variants.</p>
</div>
</div>
<div class="section level2">
<h2 id="casecontrol_se">CaseControl_SE<a class="anchor" aria-label="anchor" href="#casecontrol_se"></a>
</h2>
<p>Use this function when you have the following statistics (for each variant)</p>
<ul>
<li>Number of cases</li>
<li>Number of controls</li>
<li>Odds Ratio (OR) or beta coefficient</li>
<li>
<strong>SE</strong> of the log(OR) for each variant</li>
</ul>
<p><em>Code adapted from ReACt GroupFreq function available here: (<a href="https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c" class="external-link uri">https://github.com/Paschou-Lab/ReAct/blob/main/GrpPRS_src/CountConstruct.c</a>)</em></p>
<div class="section level3">
<h3 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h3>
<p><strong>data</strong>: a dataframe where each row is a variant and columns for the OR, SE, chromosome, and position</p>
<p><strong>N_case</strong>: an integer for the number of case samples</p>
<p><strong>N_control</strong>: an integer for the number of control samples</p>
<p><strong>OR_colname</strong>: a string containing the exact column name in <em>data</em> with the odds ratios</p>
<p><strong>SE_colname</strong>: a string containing the exact column name in <em>data</em> with the standard errors</p>
<p><strong>position_colname</strong>: a string containing the exact column name in <em>data</em> with the positions of the variants</p>
<p><strong>chromosome_colname</strong>: a string containing the exact column name in <em>data</em> with the chromosome of the variants. Note, sex chromosomes can be either characters (‘X’, ‘x’, ‘Y’, ‘y’) or numeric where X=23 and Y=24</p>
<p><strong>sex_chromosomes</strong>: boolean, TRUE if variants from sex chromosome(s) are included in the dataset</p>
<p><strong>do_correction</strong>: boolean, TRUE if data is provided to correct the estimates using proxy MAFs</p>
<p><strong>remove_sex_chromosomes</strong>: boolean, TRUE if variants on sex chromosomes should be removed. This is only necessary if <em>sex_chromosomes</em> == TRUE and the number of XX/XY individuals per case and control sample is NOT known</p>
<p>CaseControl_SE has the following optional inputs:</p>
<p>If <em>sex_chromosomes</em> == TRUE and <em>remove_sex_chromosomes</em> == FALSE, then the following inputs are required:</p>
<p><strong>N_XX_case</strong>: the number of XX chromosome case individuals</p>
<p><strong>N_XX_control</strong>: the number of XX chromosome control individuals</p>
<p><strong>N_XY_case</strong>: the number of XY chromosome case individuals</p>
<p><strong>N_XY_control</strong>: the number of XY chromosome control individuals</p>
<p>If <em>do_correction</em> == TRUE, then data must be provided that includes harmonized data with proxy MAFs</p>
<p><strong>correction_data</strong>: a dataframe with the following EXACT column names: CHR, POS, proxy_MAF, containing data for variants harmonized between the observed and proxy datasets</p>
<p>Returns the <em>data</em> dataframe with three additional columns with names: MAF_case, MAF_control and MAF_total containing the estimated minor allele frequency in the cases, controls, and total sample. The number of rows is equal to the number of variants. If proxyMAFs_colname is not NA, will include three additional columns containing the adjusted estimated MAFs (MAF_case_adj, MAF_control_adj, MAF_total_adj)</p>
<p><strong>NOTE:</strong> This method assumes we are estimating the minor allele frequency (MAF)</p>
</div>
</div>
<div class="section level2">
<h2 id="a-small-example">A small example<a class="anchor" aria-label="anchor" href="#a-small-example"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># load the data</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"sampleDat"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co"># this sample data contains 500 variants from chromosome 1 of Pan-UKBB Diabetes GWAS</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>nCase_sample <span class="ot">=</span> <span class="dv">16550</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>nControl_sample <span class="ot">=</span> <span class="dv">403923</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="fu">head</span>(sampleDat)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># A tibble: 6 × 11</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co"># Rowwise: </span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#  CHR         POS REF   ALT   true_maf_case true_maf_control      beta     SE gnomad_maf    OR true_maf_pop</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#  &lt;chr&gt;     &lt;int&gt; &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;            &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="co">#1 chr1  226824710 C     T         0.205            0.204      0.000344 0.0147  0.204     1.00     0.204    </span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a><span class="co">#2 chr1  117812346 G     A         0.448            0.447     -0.00139  0.0120  0.446     0.999    0.447    </span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co">#3 chr1  230838863 C     T         0.165            0.164      0.00422  0.0162  0.183     1.00     0.164    </span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co">#4 chr1   93121792 ATT   A         0                0         -0.106    3.53    0.000108  0.900    0        </span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="co">#5 chr1  240236388 G     A         0.0000111        0.0000378 -1.25     1.25    0.0000882 0.285    0.0000367</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="co">#6 chr1   12385196 G     A         0.0139           0.0140    -0.0153   0.0505  0.0116    0.985    0.0140 </span></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>af_method_results <span class="ot">&lt;-</span> <span class="fu">CaseControl_AF</span>(<span class="at">data =</span> sampleDat,</span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>                                    <span class="at">N_case =</span> nCase_sample,</span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>                                    <span class="at">N_control =</span> nControl_sample,</span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>                                    <span class="at">OR =</span> <span class="st">"OR"",</span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a><span class="st">                                    AF_total_colname = "</span>true_maf_pop<span class="st">")</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a><span class="st">head(af_method_results %&gt;% select(AF_case, AF_control))</span></span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a><span class="st">#       AF_case   AF_control</span></span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="st">#1 2.041813e-01 2.041254e-01</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a><span class="st">#2 4.468049e-01 4.471490e-01</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="st">#3 1.647775e-01 1.641968e-01</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a><span class="st">#4 0.000000e+00 0.000000e+00</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a><span class="st">#5 1.077692e-05 3.776488e-05</span></span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a><span class="st">#6 1.381395e-02 1.402353e-02</span></span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a><span class="st"># visualise the bias in the results compared to the published true AFs</span></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="st">plotdata &lt;- data.frame(estimated = c(af_method_results$AF_case, af_method_results$AF_control),</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="st">                       true = c(sampleDat$true_maf_case, </span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a><span class="st">                                sampleDat$true_maf_control),</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a><span class="st">                       status = c(rep("</span>Case<span class="st">", nrow(af_method_results)), </span></span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a><span class="st">                       rep("</span>Control<span class="st">", nrow(af_method_results))))</span></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a><span class="st"># plot the results</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a><span class="st">ggplot(plotdata, aes(x = true, y = estimated)) +</span></span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a><span class="st">  geom_point() +</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a><span class="st">  geom_abline(intercept = 0, slope = 1, linetype = "</span>dashed<span class="st">", color = "</span>grey40<span class="st">") +</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a><span class="st">  xlab("</span>True AF<span class="st">") + ylab("</span>Estimated AF<span class="st">") +</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a><span class="st">  theme_bw() +</span></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="st">  facet_wrap(~status)</span></span></code></pre></div>
<p><img src="reference/figures/CaseControl_AF_example.png" height="70%" width="70%"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>se_method_results <span class="ot">&lt;-</span> <span class="fu">CaseControl_SE</span>(<span class="at">data =</span> sampleDat,</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                                    <span class="at">N_case =</span> nCase_sample,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>                                    <span class="at">N_control =</span> nControl_sample,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                                    <span class="at">OR =</span> <span class="st">"OR"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>                                    <span class="at">SE =</span> <span class="st">"SE"</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>                                    <span class="at">chromosome_colname =</span> <span class="st">"CHR"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>                                    <span class="at">position_colname =</span> <span class="st">"POS"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>                                    <span class="at">sex_chromosomes =</span> F,</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>                                    <span class="at">do_correction =</span> F)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="fu">head</span>(se_method_results <span class="sc">%&gt;%</span> <span class="fu">select</span>(MAF_case, MAF_control, MAF_total))</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#      MAF_case  MAF_control    MAF_total</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#1 1.764905e-01 1.764405e-01 1.764425e-01</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#2 3.263835e-01 3.266896e-01 3.266776e-01</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#3 1.392353e-01 1.387297e-01 1.387496e-01</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="co">#4 2.513875e-06 2.794421e-06 2.783379e-06</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#5 1.946826e-05 6.821993e-05 6.630105e-05</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#6 1.250050e-02 1.269041e-02 1.268294e-02</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co"># visualize the bias in results compared to the published minor allele frequency (MAF)</span></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>plotdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">estimated =</span> <span class="fu">c</span>(se_method_results<span class="sc">$</span>MAF_case, se_method_results<span class="sc">$</span>MAF_control),</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>                       <span class="at">true =</span> <span class="fu">c</span>(sampleDat<span class="sc">$</span>true_maf_case,sampleDat<span class="sc">$</span>true_maf_control),</span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>                       <span class="at">status =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"Case"</span>, <span class="fu">nrow</span>(se_method_results)), </span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>                       <span class="fu">rep</span>(<span class="st">"Control"</span>, <span class="fu">nrow</span>(se_method_results))))</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a><span class="co"># plot the results</span></span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a><span class="fu">ggplot</span>(plotdata, <span class="fu">aes</span>(<span class="at">x =</span> true, <span class="at">y =</span> estimated)) <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">color =</span> <span class="st">"grey40"</span>) <span class="sc">+</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"True MAF"</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Estimated MAF"</span>) <span class="sc">+</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim=</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>), <span class="at">ylim=</span> <span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>status)</span></code></pre></div>
<p><img src="reference/figures/CaseControl_SE_example.png" height="70%" width="70%"></p>
<p>Here we observe distinct bias, which increases as the MAF increases. We will then use the correction framework described in our paper and implemented here to use gnomAD as a proxy for the true MAF_total.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr_dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>CHR <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">CHR</span>, POS <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">POS</span>, proxy_MAF <span class="op">=</span> <span class="va">sampleDat</span><span class="op">$</span><span class="va">gnomad_maf</span><span class="op">)</span></span>
<span></span>
<span><span class="va">se_method_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CaseControl_SE.html">CaseControl_SE</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sampleDat</span>,</span>
<span>                                    N_case <span class="op">=</span> <span class="va">nCase_sample</span>,</span>
<span>                                     N_control <span class="op">=</span> <span class="va">nControl_sample</span>,</span>
<span>                                     OR_colname <span class="op">=</span> <span class="st">"OR"</span>,</span>
<span>                                     SE_colname <span class="op">=</span> <span class="st">"SE"</span>, </span>
<span>                                     chromosome_colname <span class="op">=</span> <span class="st">"CHR"</span>,</span>
<span>                                     position_colname <span class="op">=</span> <span class="st">"POS"</span>,</span>
<span>                                     sex_chromosomes <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                     do_correction <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                     correction_data <span class="op">=</span> <span class="va">corr_dat</span><span class="op">)</span></span>
<span>                                     </span>
<span><span class="va">plotdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>true_maf_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>, <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,</span>
<span>                                        <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span>, <span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span><span class="op">)</span>,</span>
<span>                       maf_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case</span>,</span>
<span>                                   <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case_adj</span>,</span>
<span>                                   <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control</span>,</span>
<span>                                   <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control_adj</span><span class="op">)</span>,</span>
<span>                       pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                       type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Uncorrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Corrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Uncorrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Corrected"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sampleDat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                                     </span>
<span><span class="va">ccc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Corrected"</span>, <span class="st">"Corrected"</span>, <span class="st">"Uncorrected"</span>, <span class="st">"Uncorrected"</span><span class="op">)</span>,</span>
<span>                  pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Case"</span>, <span class="st">"Control"</span>, <span class="st">"Case"</span>, <span class="st">"Control"</span><span class="op">)</span>,</span>
<span>                  ccc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case_adj</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>,</span>
<span>                          <span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control_adj</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>,</span>
<span>                          <span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_case</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_case</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span>,</span>
<span>                          <span class="fu">CCC</span><span class="op">(</span><span class="va">sampleDat</span><span class="op">$</span><span class="va">true_maf_control</span>,</span>
<span>                              <span class="va">se_method_results</span><span class="op">$</span><span class="va">MAF_control</span><span class="op">)</span><span class="op">$</span><span class="va">rho.c</span><span class="op">$</span><span class="va">est</span><span class="op">)</span>,</span>
<span>                  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.07</span>, <span class="fl">0.07</span>, <span class="fl">0.07</span>, <span class="fl">0.07</span><span class="op">)</span>,</span>
<span>                  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.46</span>, <span class="fl">0.46</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ccc</span><span class="op">$</span><span class="va">ccc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ccc</span><span class="op">$</span><span class="va">ccc</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">ccc</span><span class="op">$</span><span class="va">label</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"CCC = "</span>, <span class="va">ccc</span><span class="op">$</span><span class="va">ccc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">plotdata</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">true_maf_pop</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span>, </span>
<span>                 <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">true_maf_pop</span>, y <span class="op">=</span> <span class="va">maf_pop</span>, color <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text</span><span class="op">(</span>data <span class="op">=</span> <span class="va">ccc</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="va">label</span>, colour <span class="op">=</span> <span class="va">type</span><span class="op">)</span>, show.legend <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grey40"</span>, <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span>slope <span class="op">=</span> <span class="fl">1</span>, intercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Estimated vs True With gnomAD Adjustment"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"True MAF (Y)"</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ylab</span><span class="op">(</span><span class="st">"Estimated MAF (Y')"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">pop</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>        axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        legend.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>                                     </span></code></pre></div>
<p><img src="reference/figures/CaseControl_SE_withCorr.png" height="70%" width="70%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/wolffha/CaseControlAF/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/wolffha/CaseControlAF/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing CaseControlAF</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Hayley Wolff <br><small class="roles"> Maintainer, author </small>  </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Hayley Wolff.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
